<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architecture/trd" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Technical Reference Document | Gantral</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.gantral.org/img/gantral-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.gantral.org/img/gantral-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.gantral.org/architecture/trd"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Technical Reference Document | Gantral"><meta data-rh="true" name="description" content="Status: Living technical reference (v1.1)"><meta data-rh="true" property="og:description" content="Status: Living technical reference (v1.1)"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.gantral.org/architecture/trd"><link data-rh="true" rel="alternate" href="https://docs.gantral.org/architecture/trd" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.gantral.org/architecture/trd" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Architecture","item":"https://docs.gantral.org/architecture/"},{"@type":"ListItem","position":2,"name":"Technical Reference Document","item":"https://docs.gantral.org/architecture/trd"}]}</script><link rel="stylesheet" href="/assets/css/styles.8cf77017.css">
<script src="/assets/js/runtime~main.60b241f8.js" defer="defer"></script>
<script src="/assets/js/main.06c372b0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Gantral Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Gantral Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gantral</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Rainminds/gantral" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Welcome to Gantral" class="linkLabel_WmDU">Welcome to Gantral</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/architecture"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/data-and-audit"><span title="Data and Audit Model" class="linkLabel_WmDU">Data and Audit Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/execution-plane"><span title="Execution Plane" class="linkLabel_WmDU">Execution Plane</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/invariants"><span title="Architectural Invariants" class="linkLabel_WmDU">Architectural Invariants</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/security-and-boundaries"><span title="Security and Trust Boundaries" class="linkLabel_WmDU">Security and Trust Boundaries</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/state-machine"><span title="Execution State Machine" class="linkLabel_WmDU">Execution State Machine</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/architecture/trd"><span title="Technical Reference Document" class="linkLabel_WmDU">Technical Reference Document</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/contributors/cla"><span title="contributors" class="categoryLinkLabel_W154">contributors</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/governance"><span title="Governance" class="categoryLinkLabel_W154">Governance</span></a><button aria-label="Expand sidebar category &#x27;Governance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/positioning"><span title="Positioning" class="categoryLinkLabel_W154">Positioning</span></a><button aria-label="Expand sidebar category &#x27;Positioning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/product"><span title="Product" class="categoryLinkLabel_W154">Product</span></a><button aria-label="Expand sidebar category &#x27;Product&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/architecture"><span>Architecture</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Technical Reference Document</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Technical Reference Document</h1></header>
<p><strong>Status:</strong> Living technical reference (v1.1)</p>
<p><strong>Purpose:</strong> This document is the technical constitution of the <strong>Gantral open-source core</strong>. It is not intended to describe the features of the commercial Gantrio platform. It is designed to directly inform:</p>
<ul>
<li class="">Implementation sequencing</li>
<li class="">Repository structure</li>
<li class="">Architecture &amp; design decisions</li>
<li class="">Security, privacy, and compliance posture</li>
<li class="">OSS governance and licensing</li>
</ul>
<p>This document is intentionally detailed and opinionated. If an implementation conflicts with this document, the implementation is wrong.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-scope--nongoals">1. Scope &amp; Non‑Goals<a href="#1-scope--nongoals" class="hash-link" aria-label="Direct link to 1. Scope &amp; Non‑Goals" title="Direct link to 1. Scope &amp; Non‑Goals" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-what-gantral-is-technical-definition">1.1 What Gantral Is (Technical Definition)<a href="#11-what-gantral-is-technical-definition" class="hash-link" aria-label="Direct link to 1.1 What Gantral Is (Technical Definition)" title="Direct link to 1.1 What Gantral Is (Technical Definition)" translate="no">​</a></h3>
<p>Gantral is an AI Execution Control Plane that standardizes how AI-driven workflows execute, pause, escalate, and are audited across teams and systems.</p>
<p>Technically, Gantral provides:</p>
<ul>
<li class="">A deterministic execution state machine.</li>
<li class="">Human‑in‑the‑Loop (HITL) as a first‑class state transition.</li>
<li class="">Instance‑level isolation for audit, cost, and accountability.</li>
<li class="">Declarative policies for materiality, escalation, and authority.</li>
<li class="">Control APIs and SDKs that sit above agent frameworks and below enterprise processes.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-explicit-nongoals-hard-exclusions">1.2 Explicit Non‑Goals (Hard Exclusions)<a href="#12-explicit-nongoals-hard-exclusions" class="hash-link" aria-label="Direct link to 1.2 Explicit Non‑Goals (Hard Exclusions)" title="Direct link to 1.2 Explicit Non‑Goals (Hard Exclusions)" translate="no">​</a></h3>
<p>Gantral will not:</p>
<ul>
<li class="">Build or host AI agents.</li>
<li class="">Optimize prompts or models.</li>
<li class="">Train or fine‑tune models.</li>
<li class="">Replace CI/CD, Jira, GitHub, or ITSM systems.</li>
<li class="">Provide autonomous decision loops.</li>
<li class="">Make probabilistic decisions without human accountability.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-architectural-invariants-nonnegotiable">2. Architectural Invariants (Non‑Negotiable)<a href="#2-architectural-invariants-nonnegotiable" class="hash-link" aria-label="Direct link to 2. Architectural Invariants (Non‑Negotiable)" title="Direct link to 2. Architectural Invariants (Non‑Negotiable)" translate="no">​</a></h2>
<p>These invariants must hold across all implementations:</p>
<ol>
<li class=""><strong>Instance‑First Semantics:</strong> All audit, cost, authority, and replay semantics attach to instances, never agents or workflows.</li>
<li class=""><strong>HITL Is a State Transition:</strong> Human intervention is modeled inside the execution graph, not as an external approval system.</li>
<li class=""><strong>Human Authority Is Final:</strong> AI output is advisory; policy‑enforced human decisions override AI.</li>
<li class=""><strong>Determinism &gt; Performance:</strong> Immutable logs, replayability, and auditability take precedence over latency optimizations.</li>
<li class=""><strong>Declarative Control:</strong> Policies, materiality rules, and escalation paths are configuration (YAML/JSON), not embedded code.</li>
<li class=""><strong>Adapters Contain No Business Logic:</strong> Integrations emit events and accept decisions only.</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-highlevel-architecture">3. High‑Level Architecture<a href="#3-highlevel-architecture" class="hash-link" aria-label="Direct link to 3. High‑Level Architecture" title="Direct link to 3. High‑Level Architecture" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-logical-architecture-layers">3.1 Logical Architecture Layers<a href="#31-logical-architecture-layers" class="hash-link" aria-label="Direct link to 3.1 Logical Architecture Layers" title="Direct link to 3.1 Logical Architecture Layers" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-runtime-model">3.2 Runtime Model<a href="#32-runtime-model" class="hash-link" aria-label="Direct link to 3.2 Runtime Model" title="Direct link to 3.2 Runtime Model" translate="no">​</a></h3>
<ol>
<li class=""><strong>Trigger</strong> (PR opened, incident created, ticket updated)</li>
<li class=""><strong>Workflow</strong> selected (template)</li>
<li class=""><strong>Instance</strong> created (immutable ID)</li>
<li class=""><strong>Execution</strong> proceeds</li>
<li class=""><strong>Policy</strong> evaluation</li>
<li class=""><strong>HITL transition</strong> (if required)</li>
<li class=""><strong>Decision</strong> captured</li>
<li class=""><strong>Execution</strong> resumes or terminates</li>
<li class=""><strong>Audit log</strong> sealed</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-execution-plane-responsibility-boundary">3.3 Execution Plane Responsibility Boundary<a href="#33-execution-plane-responsibility-boundary" class="hash-link" aria-label="Direct link to 3.3 Execution Plane Responsibility Boundary" title="Direct link to 3.3 Execution Plane Responsibility Boundary" translate="no">​</a></h3>
<p>Gantral implements a centralized <strong>execution plane</strong> that governs AI-enabled workflows across heterogeneous agent frameworks.</p>
<p>In this model:</p>
<ul>
<li class="">Agents perform computation and emit execution events</li>
<li class="">Gantral owns authorization, approval, and state transitions</li>
<li class="">Agents cannot advance execution past governed states independently</li>
</ul>
<p>This separation ensures consistent governance, auditability, and policy enforcement regardless of how or where AI logic is implemented.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="34-execution-readiness--scheduling-non-canonical">3.4 Execution Readiness &amp; Scheduling (Non-Canonical)<a href="#34-execution-readiness--scheduling-non-canonical" class="hash-link" aria-label="Direct link to 3.4 Execution Readiness &amp; Scheduling (Non-Canonical)" title="Direct link to 3.4 Execution Readiness &amp; Scheduling (Non-Canonical)" translate="no">​</a></h3>
<p>Gantral distinguishes between <strong>execution state</strong> and <strong>execution readiness</strong>.</p>
<p>An execution <em>state</em> represents a canonical, immutable fact about an instance and is recorded in the execution log (see Section 5).
Execution <em>readiness</em> is a <strong>dynamic property</strong> evaluated by the execution plane to determine whether an instance can advance execution <em>at this moment</em>.</p>
<p>An instance MAY be in the <code>RUNNING</code> state but temporarily <strong>not runnable</strong> due to execution-plane constraints, including but not limited to:</p>
<ul>
<li class="">Compute or model capacity availability</li>
<li class="">Rate limits or quotas</li>
<li class="">Backpressure or fairness controls</li>
<li class="">Concurrency limits</li>
<li class="">Infrastructure scheduling delays</li>
</ul>
<p>Execution readiness is:</p>
<ul>
<li class=""><strong>Derived, not persisted</strong></li>
<li class=""><strong>Evaluated continuously at runtime</strong></li>
<li class=""><strong>Not part of the execution state machine</strong></li>
<li class=""><strong>Excluded from audit logs and replay semantics</strong></li>
</ul>
<p>Formally:
<code>runnable(instance) = execution_state == RUNNING AND no pending HITL decisions AND no policy blocks AND execution plane capacity is available</code></p>
<p>This separation ensures:</p>
<ul>
<li class="">Deterministic execution history</li>
<li class="">Clean replay semantics</li>
<li class="">Clear separation between governance (state, policy) and operations (scheduling)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-core-domain-model">4. Core Domain Model<a href="#4-core-domain-model" class="hash-link" aria-label="Direct link to 4. Core Domain Model" title="Direct link to 4. Core Domain Model" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-core-entities">4.1 Core Entities<a href="#41-core-entities" class="hash-link" aria-label="Direct link to 4.1 Core Entities" title="Direct link to 4.1 Core Entities" translate="no">​</a></h3>
<p><strong>Workflow (Template)</strong></p>
<ul>
<li class="">ID, version</li>
<li class="">Step graph</li>
<li class="">Trigger definitions</li>
<li class="">Policy references</li>
<li class="">Materiality level</li>
</ul>
<p><strong>Instance (Execution)</strong></p>
<ul>
<li class="">Immutable <code>instance_id</code></li>
<li class=""><code>workflow_id</code> + version</li>
<li class=""><code>owning_team_id</code></li>
<li class="">Trigger context (PR, incident, etc.)</li>
<li class="">Execution state</li>
<li class="">Timestamps</li>
<li class="">Cost metadata</li>
</ul>
<p><strong>HITL Decision</strong></p>
<ul>
<li class=""><code>decision_id</code></li>
<li class=""><code>instance_id</code></li>
<li class=""><code>decision_type</code> (APPROVE / REJECT / OVERRIDE)</li>
<li class=""><code>human_actor_id</code></li>
<li class=""><code>role</code></li>
<li class=""><code>justification</code> (notes or reason)</li>
<li class=""><code>context_snapshot</code> (what the human saw)</li>
</ul>
<p><strong>Policy</strong></p>
<ul>
<li class="">Materiality thresholds</li>
<li class="">Approval rules</li>
<li class="">Escalation paths</li>
<li class="">SLA &amp; timeout rules</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-execution-state-machine">5. Execution State Machine<a href="#5-execution-state-machine" class="hash-link" aria-label="Direct link to 5. Execution State Machine" title="Direct link to 5. Execution State Machine" translate="no">​</a></h2>
<p><em>(See <a class="" href="/architecture/state-machine">State Machine Documentation</a> for detailed diagrams and transitions).</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-policy-engine">6. Policy Engine<a href="#6-policy-engine" class="hash-link" aria-label="Direct link to 6. Policy Engine" title="Direct link to 6. Policy Engine" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="61-policy-characteristics">6.1 Policy Characteristics<a href="#61-policy-characteristics" class="hash-link" aria-label="Direct link to 6.1 Policy Characteristics" title="Direct link to 6.1 Policy Characteristics" translate="no">​</a></h3>
<ul>
<li class="">Declarative (YAML/JSON)</li>
<li class="">Versioned</li>
<li class="">Evaluated at runtime</li>
<li class="">Hot‑reloadable</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="62-example-policy-illustrative">6.2 Example Policy (Illustrative)<a href="#62-example-policy-illustrative" class="hash-link" aria-label="Direct link to 6.2 Example Policy (Illustrative)" title="Direct link to 6.2 Example Policy (Illustrative)" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">materiality</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> HIGH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">requires_human_approval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">approvers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TECH_LEAD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SECURITY_REVIEWER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">timeouts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">primary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 30m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">escalation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 60m</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-apis--sdks">7. APIs &amp; SDKs<a href="#7-apis--sdks" class="hash-link" aria-label="Direct link to 7. APIs &amp; SDKs" title="Direct link to 7. APIs &amp; SDKs" translate="no">​</a></h2>
<ul>
<li class=""><strong>7.1 API Style:</strong> REST + gRPC (initially REST), OpenAPI 3.1 spec, Versioned endpoints.</li>
<li class=""><strong>7.2 Core API Groups:</strong> <code>/workflows</code>, <code>/instances</code>, <code>/decisions</code>, <code>/policies</code>, <code>/audit</code>, <code>/replay</code>.</li>
<li class=""><strong>7.3 Reference SDKs (Phase 1):</strong> Python, Go, TypeScript. SDKs are thin wrappers; all logic remains server-side.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-repository-structure">8. Repository Structure<a href="#8-repository-structure" class="hash-link" aria-label="Direct link to 8. Repository Structure" title="Direct link to 8. Repository Structure" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="81-monorepo-recommended">8.1 Monorepo (Recommended)<a href="#81-monorepo-recommended" class="hash-link" aria-label="Direct link to 8.1 Monorepo (Recommended)" title="Direct link to 8.1 Monorepo (Recommended)" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/gantral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /specs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /engine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /hitl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /audit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /sdk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /typescript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /adapters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /infra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /tests</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="82-repo-principles">8.2 Repo Principles<a href="#82-repo-principles" class="hash-link" aria-label="Direct link to 8.2 Repo Principles" title="Direct link to 8.2 Repo Principles" translate="no">​</a></h3>
<p>Specs first, code follows spec, no UI in OSS core.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="9-data-stores">9. Data Stores<a href="#9-data-stores" class="hash-link" aria-label="Direct link to 9. Data Stores" title="Direct link to 9. Data Stores" translate="no">​</a></h2>
<table><thead><tr><th>Purpose</th><th>Technology</th></tr></thead><tbody><tr><td>Execution state</td><td>PostgreSQL (event‑sourced tables)</td></tr><tr><td>Immutable logs</td><td>Append‑only log store (Postgres / ClickHouse)</td></tr><tr><td>Replay snapshots</td><td>Object storage (S3‑compatible)</td></tr><tr><td>Caching</td><td>Redis (optional)</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="10-security-architecture">10. Security Architecture<a href="#10-security-architecture" class="hash-link" aria-label="Direct link to 10. Security Architecture" title="Direct link to 10. Security Architecture" translate="no">​</a></h2>
<ul>
<li class=""><strong>10.1 Identity &amp; Auth:</strong> OAuth 2.0 / OIDC, Service accounts per agent, Short‑lived tokens.</li>
<li class=""><strong>10.2 Authorization:</strong> Policy‑driven RBAC, Least privilege.</li>
<li class=""><strong>10.3 Secrets:</strong> External secret manager (Vault, AWS Secrets Manager), No secrets in repo or config.</li>
<li class=""><strong>10.4 Audit Guarantees:</strong> 100% decision capture, Tamper‑evident logs, Cryptographic hashing of execution chains.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-privacy--compliance">11. Privacy &amp; Compliance<a href="#11-privacy--compliance" class="hash-link" aria-label="Direct link to 11. Privacy &amp; Compliance" title="Direct link to 11. Privacy &amp; Compliance" translate="no">​</a></h2>
<ul>
<li class=""><strong>11.1 Data Minimization:</strong> Store decisions, not raw prompts unless required. Configurable redaction.</li>
<li class=""><strong>11.2 Compliance Targets:</strong> SOC2 (design‑ready), GDPR (data locality support), Enterprise audit readiness.</li>
<li class=""><strong>11.3 Air‑Gapped Support:</strong> No external hard dependencies, Offline deployment supported.</li>
</ul>
<p>Gantral’s compliance posture is a direct consequence of its execution model. By enforcing human oversight, authorization, and audit at the execution layer, regulatory requirements are satisfied structurally rather than procedurally.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-infrastructure--iac">12. Infrastructure &amp; IaC<a href="#12-infrastructure--iac" class="hash-link" aria-label="Direct link to 12. Infrastructure &amp; IaC" title="Direct link to 12. Infrastructure &amp; IaC" translate="no">​</a></h2>
<ul>
<li class=""><strong>12.1 Deployment Targets:</strong> Kubernetes (primary), Docker Compose (dev/test).</li>
<li class=""><strong>12.2 IaC Tools:</strong> Terraform, Helm.</li>
<li class=""><strong>12.3 Observability:</strong> OpenTelemetry, Prometheus metrics, Structured logs.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="13-standards--interoperability">13. Standards &amp; Interoperability<a href="#13-standards--interoperability" class="hash-link" aria-label="Direct link to 13. Standards &amp; Interoperability" title="Direct link to 13. Standards &amp; Interoperability" translate="no">​</a></h2>
<ul>
<li class="">OpenAPI 3.1</li>
<li class="">OpenTelemetry</li>
<li class="">OAuth 2.0 / OIDC</li>
<li class="">CNCF-aligned design principles (operability, portability, extensibility)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="14-licensing--governance">14. Licensing &amp; Governance<a href="#14-licensing--governance" class="hash-link" aria-label="Direct link to 14. Licensing &amp; Governance" title="Direct link to 14. Licensing &amp; Governance" translate="no">​</a></h2>
<p><em>(See <a class="" href="/governance/oss-philosophy">Governance Documentation</a> for details).</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="15-implementation-phasing">15. Implementation Phasing<a href="#15-implementation-phasing" class="hash-link" aria-label="Direct link to 15. Implementation Phasing" title="Direct link to 15. Implementation Phasing" translate="no">​</a></h2>
<ul>
<li class=""><strong>Phase 1:</strong> Core execution engine, HITL state machine, Instance API.</li>
<li class=""><strong>Phase 2:</strong> Policy engine, Deterministic replay, SDKs.</li>
<li class=""><strong>Phase 3:</strong> Enterprise‑grade audit, Adapter framework, Hardening &amp; docs.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="16-final-principle">16. Final Principle<a href="#16-final-principle" class="hash-link" aria-label="Direct link to 16. Final Principle" title="Direct link to 16. Final Principle" translate="no">​</a></h2>
<p>Gantral is not about what AI can do. It is about what organizations are willing to allow AI to do—and how they prove it. This document is the reference. Deviations require explicit architectural justification.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/Rainminds/gantral/tree/main/../docs/architecture/trd.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/architecture/state-machine"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Execution State Machine</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/contributors/cla"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributor License Agreement (CLA)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-scope--nongoals" class="table-of-contents__link toc-highlight">1. Scope &amp; Non‑Goals</a><ul><li><a href="#11-what-gantral-is-technical-definition" class="table-of-contents__link toc-highlight">1.1 What Gantral Is (Technical Definition)</a></li><li><a href="#12-explicit-nongoals-hard-exclusions" class="table-of-contents__link toc-highlight">1.2 Explicit Non‑Goals (Hard Exclusions)</a></li></ul></li><li><a href="#2-architectural-invariants-nonnegotiable" class="table-of-contents__link toc-highlight">2. Architectural Invariants (Non‑Negotiable)</a></li><li><a href="#3-highlevel-architecture" class="table-of-contents__link toc-highlight">3. High‑Level Architecture</a><ul><li><a href="#31-logical-architecture-layers" class="table-of-contents__link toc-highlight">3.1 Logical Architecture Layers</a></li><li><a href="#32-runtime-model" class="table-of-contents__link toc-highlight">3.2 Runtime Model</a></li><li><a href="#33-execution-plane-responsibility-boundary" class="table-of-contents__link toc-highlight">3.3 Execution Plane Responsibility Boundary</a></li><li><a href="#34-execution-readiness--scheduling-non-canonical" class="table-of-contents__link toc-highlight">3.4 Execution Readiness &amp; Scheduling (Non-Canonical)</a></li></ul></li><li><a href="#4-core-domain-model" class="table-of-contents__link toc-highlight">4. Core Domain Model</a><ul><li><a href="#41-core-entities" class="table-of-contents__link toc-highlight">4.1 Core Entities</a></li></ul></li><li><a href="#5-execution-state-machine" class="table-of-contents__link toc-highlight">5. Execution State Machine</a></li><li><a href="#6-policy-engine" class="table-of-contents__link toc-highlight">6. Policy Engine</a><ul><li><a href="#61-policy-characteristics" class="table-of-contents__link toc-highlight">6.1 Policy Characteristics</a></li><li><a href="#62-example-policy-illustrative" class="table-of-contents__link toc-highlight">6.2 Example Policy (Illustrative)</a></li></ul></li><li><a href="#7-apis--sdks" class="table-of-contents__link toc-highlight">7. APIs &amp; SDKs</a></li><li><a href="#8-repository-structure" class="table-of-contents__link toc-highlight">8. Repository Structure</a><ul><li><a href="#81-monorepo-recommended" class="table-of-contents__link toc-highlight">8.1 Monorepo (Recommended)</a></li><li><a href="#82-repo-principles" class="table-of-contents__link toc-highlight">8.2 Repo Principles</a></li></ul></li><li><a href="#9-data-stores" class="table-of-contents__link toc-highlight">9. Data Stores</a></li><li><a href="#10-security-architecture" class="table-of-contents__link toc-highlight">10. Security Architecture</a></li><li><a href="#11-privacy--compliance" class="table-of-contents__link toc-highlight">11. Privacy &amp; Compliance</a></li><li><a href="#12-infrastructure--iac" class="table-of-contents__link toc-highlight">12. Infrastructure &amp; IaC</a></li><li><a href="#13-standards--interoperability" class="table-of-contents__link toc-highlight">13. Standards &amp; Interoperability</a></li><li><a href="#14-licensing--governance" class="table-of-contents__link toc-highlight">14. Licensing &amp; Governance</a></li><li><a href="#15-implementation-phasing" class="table-of-contents__link toc-highlight">15. Implementation Phasing</a></li><li><a href="#16-final-principle" class="table-of-contents__link toc-highlight">16. Final Principle</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Rainminds/gantral" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Gantral, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>