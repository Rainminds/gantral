"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[6246],{6099(e,i,n){n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"architecture/authority-state-machine","title":"Authority State Machine","description":"Gantral enforces execution authority through a strict, deterministic authority state machine.","source":"@site/../docs/architecture/authority-state-machine.md","sourceDirName":"architecture","slug":"/architecture/authority-state-machine","permalink":"/architecture/authority-state-machine","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Authority State Machine"},"sidebar":"docsSidebar","previous":{"title":"Technical Reference Document","permalink":"/architecture/trd"},"next":{"title":"Execution Authority vs Agent Memory vs Runtime","permalink":"/architecture/execution-authority-vs-agent-memory"}}');var s=n(4848),r=n(8453);const a={title:"Authority State Machine"},o="Authority State Machine",c={},l=[{value:"Purpose of the Authority State Machine",id:"purpose-of-the-authority-state-machine",level:2},{value:"Lifecycle Diagram",id:"lifecycle-diagram",level:2},{value:"State Definitions",id:"state-definitions",level:2},{value:"WAITING_FOR_HUMAN Is a Gate, Not a Pause",id:"waiting_for_human-is-a-gate-not-a-pause",level:2},{value:"Deterministic Authority Transitions",id:"deterministic-authority-transitions",level:2},{value:"Relationship to Policy Evaluation",id:"relationship-to-policy-evaluation",level:2},{value:"Commitment Artifact Emission",id:"commitment-artifact-emission",level:2},{value:"Invariants &amp; Guarantees",id:"invariants--guarantees",level:2},{value:"Failure Behavior",id:"failure-behavior",level:2},{value:"Relationship to Verifiability",id:"relationship-to-verifiability",level:2},{value:"Guiding Principle",id:"guiding-principle",level:2}];function h(e){const i={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"authority-state-machine",children:"Authority State Machine"})}),"\n",(0,s.jsxs)(i.p,{children:["Gantral enforces execution authority through a ",(0,s.jsx)(i.strong,{children:"strict, deterministic authority state machine"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:["This state machine is not an implementation detail.\nIt is the ",(0,s.jsx)(i.strong,{children:"mechanism by which authority is enforced, paused, escalated, and proven"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"No execution may proceed past a controlled boundary unless the corresponding\nauthority state transition is valid, recorded, and committed."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"purpose-of-the-authority-state-machine",children:"Purpose of the Authority State Machine"}),"\n",(0,s.jsx)(i.p,{children:"The authority state machine exists to ensure that:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["execution authority is ",(0,s.jsx)(i.strong,{children:"explicit"}),", not implied"]}),"\n",(0,s.jsxs)(i.li,{children:["escalation and human oversight are ",(0,s.jsx)(i.strong,{children:"enforced"}),", not advisory"]}),"\n",(0,s.jsxs)(i.li,{children:["authority decisions are ",(0,s.jsx)(i.strong,{children:"inseparable from execution"})]}),"\n",(0,s.jsxs)(i.li,{children:["every consequential transition produces ",(0,s.jsx)(i.strong,{children:"verifiable evidence"})]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["This state machine governs ",(0,s.jsx)(i.strong,{children:"execution permission"}),", not business logic."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"lifecycle-diagram",children:"Lifecycle Diagram"}),"\n",(0,s.jsxs)(i.p,{children:["The following diagram illustrates the ",(0,s.jsx)(i.strong,{children:"only valid authority transitions"}),"\nfor a Gantral execution instance."]}),"\n",(0,s.jsxs)(i.p,{children:["Any transition not represented here is ",(0,s.jsx)(i.strong,{children:"invalid"}),"."]}),"\n",(0,s.jsx)(i.mermaid,{value:'stateDiagram-v2\n    [*] --\x3e CREATED\n\n    CREATED --\x3e RUNNING\n\n    RUNNING --\x3e WAITING_FOR_HUMAN: Policy or Threshold Trigger\n    RUNNING --\x3e COMPLETED: Execution Finished\n    RUNNING --\x3e TERMINATED: Error or Policy Denial\n\n    state "Authority Gate" as AuthorityGate {\n        WAITING_FOR_HUMAN --\x3e APPROVED: Human Authorizes\n        WAITING_FOR_HUMAN --\x3e REJECTED: Human Denies\n        WAITING_FOR_HUMAN --\x3e OVERRIDDEN: Human Authorizes with Modified Context\n    }\n\n    APPROVED --\x3e RESUMED\n    OVERRIDDEN --\x3e RESUMED\n\n    RESUMED --\x3e RUNNING: New Worker / Fresh Context\n\n    REJECTED --\x3e TERMINATED\n\n    COMPLETED --\x3e [*]\n    TERMINATED --\x3e [*]'}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"state-definitions",children:"State Definitions"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"State"}),(0,s.jsx)(i.th,{children:"Authority Semantics"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"CREATED"})}),(0,s.jsx)(i.td,{children:"Execution instance exists. No execution authority has yet been exercised."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"RUNNING"})}),(0,s.jsx)(i.td,{children:"Execution is permitted under current authority constraints."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"WAITING_FOR_HUMAN"})}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.strong,{children:"Hard Authority Gate."})," Execution is suspended because automated authority is insufficient. No execution may proceed in this state."]})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"APPROVED"})}),(0,s.jsx)(i.td,{children:"A human actor explicitly granted authority to continue under the existing context."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"REJECTED"})}),(0,s.jsx)(i.td,{children:"A human actor explicitly denied authority. Execution must terminate."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"OVERRIDDEN"})}),(0,s.jsxs)(i.td,{children:["A human actor granted authority ",(0,s.jsx)(i.strong,{children:"with modified parameters"}),", replacing the prior execution context."]})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"RESUMED"})}),(0,s.jsx)(i.td,{children:"Transitional state indicating authority has been granted and execution may restart under a fresh runtime context."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"COMPLETED"})}),(0,s.jsx)(i.td,{children:"Execution finished successfully under valid authority."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"TERMINATED"})}),(0,s.jsx)(i.td,{children:"Execution stopped due to rejection, error, or policy denial."})]})]})]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"waiting_for_human-is-a-gate-not-a-pause",children:"WAITING_FOR_HUMAN Is a Gate, Not a Pause"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"WAITING_FOR_HUMAN"})," is a ",(0,s.jsx)(i.strong,{children:"deterministic authority gate"}),", not a convenience pause."]}),"\n",(0,s.jsx)(i.p,{children:"While in this state:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"no agent code may run"}),"\n",(0,s.jsx)(i.li,{children:"no side effects may occur"}),"\n",(0,s.jsx)(i.li,{children:"no progress is permitted"}),"\n",(0,s.jsxs)(i.li,{children:["authority is ",(0,s.jsx)(i.strong,{children:"explicitly absent"})]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["From an execution standpoint, the agent process ",(0,s.jsx)(i.strong,{children:"should exit"}),".\nResumption requires a ",(0,s.jsx)(i.strong,{children:"new process"})," with fresh context supplied by Gantral."]}),"\n",(0,s.jsx)(i.p,{children:"This design ensures:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"zero implicit trust"}),"\n",(0,s.jsx)(i.li,{children:"no hidden continuation"}),"\n",(0,s.jsx)(i.li,{children:"no reliance on agent memory"}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"deterministic-authority-transitions",children:"Deterministic Authority Transitions"}),"\n",(0,s.jsxs)(i.p,{children:["All transitions out of ",(0,s.jsx)(i.code,{children:"WAITING_FOR_HUMAN"})," require:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"an authenticated human actor"}),"\n",(0,s.jsx)(i.li,{children:"an explicit authority decision"}),"\n",(0,s.jsx)(i.li,{children:"a committed state transition"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["An agent ",(0,s.jsx)(i.strong,{children:"cannot"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"approve itself"}),"\n",(0,s.jsx)(i.li,{children:"bypass the gate"}),"\n",(0,s.jsx)(i.li,{children:"resume execution implicitly"}),"\n",(0,s.jsx)(i.li,{children:"modify authority state"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Authority transitions are ",(0,s.jsx)(i.strong,{children:"externally driven and recorded"}),"."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"relationship-to-policy-evaluation",children:"Relationship to Policy Evaluation"}),"\n",(0,s.jsxs)(i.p,{children:["Policy engines (e.g., OPA) may ",(0,s.jsx)(i.strong,{children:"trigger"})," a transition to ",(0,s.jsx)(i.code,{children:"WAITING_FOR_HUMAN"}),",\nbut they ",(0,s.jsx)(i.strong,{children:"cannot authorize execution"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"Policy evaluation:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"advises"}),"\n",(0,s.jsx)(i.li,{children:"signals thresholds"}),"\n",(0,s.jsx)(i.li,{children:"recommends escalation"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Authority enforcement:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"occurs only through state transitions"}),"\n",(0,s.jsx)(i.li,{children:"is committed by Gantral"}),"\n",(0,s.jsx)(i.li,{children:"produces verifiable artifacts"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Policy signals do not grant authority.\nState transitions do."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"commitment-artifact-emission",children:"Commitment Artifact Emission"}),"\n",(0,s.jsxs)(i.p,{children:["A ",(0,s.jsx)(i.strong,{children:"commitment artifact"})," is emitted whenever:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"authority is enforced"}),"\n",(0,s.jsx)(i.li,{children:"execution transitions across an authority boundary"}),"\n",(0,s.jsx)(i.li,{children:"execution is allowed, resumed, or terminated"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Specifically:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["transitions into ",(0,s.jsx)(i.code,{children:"WAITING_FOR_HUMAN"})]}),"\n",(0,s.jsxs)(i.li,{children:["transitions into ",(0,s.jsx)(i.code,{children:"RESUMED"})]}),"\n",(0,s.jsxs)(i.li,{children:["transitions into ",(0,s.jsx)(i.code,{children:"TERMINATED"})]}),"\n",(0,s.jsxs)(i.li,{children:["transitions into ",(0,s.jsx)(i.code,{children:"COMPLETED"})]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["There is ",(0,s.jsx)(i.strong,{children:"no valid transition"})," in which:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"authority changes"}),"\n",(0,s.jsx)(i.li,{children:"execution proceeds"}),"\n",(0,s.jsx)(i.li,{children:"and no artifact is emitted"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"No artifact \u2192 no execution."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"invariants--guarantees",children:"Invariants & Guarantees"}),"\n",(0,s.jsx)(i.p,{children:"The authority state machine enforces the following invariants:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Append-Only Authority History"}),"\nAuthority state is never mutated. Every transition is recorded as a new event."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Explicit Authority Only"}),"\nExecution authority exists only in states where it is explicitly granted."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"No Implicit Resume"}),"\nResumption always requires a fresh runtime and explicit authority transition."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Deterministic Semantics"}),"\nGiven identical inputs, authority transitions are reproducible and replayable."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Failure Over Ambiguity"}),"\nIf authority state is unclear, execution must not proceed."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"failure-behavior",children:"Failure Behavior"}),"\n",(0,s.jsxs)(i.p,{children:["The state machine is designed to ",(0,s.jsx)(i.strong,{children:"fail closed"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"Execution must be refused when:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"authority state is ambiguous"}),"\n",(0,s.jsx)(i.li,{children:"required human authority is unavailable"}),"\n",(0,s.jsx)(i.li,{children:"escalation cannot be resolved"}),"\n",(0,s.jsx)(i.li,{children:"artifact emission fails"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["Failure to proceed is ",(0,s.jsx)(i.strong,{children:"correct behavior"}),"."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"relationship-to-verifiability",children:"Relationship to Verifiability"}),"\n",(0,s.jsxs)(i.p,{children:["The authority state machine is the ",(0,s.jsx)(i.strong,{children:"structural foundation"})," of Gantral\u2019s\nverifiability guarantees."]}),"\n",(0,s.jsx)(i.p,{children:"Replay and verification depend on the fact that:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"authority is always represented as state"}),"\n",(0,s.jsx)(i.li,{children:"state transitions are deterministic"}),"\n",(0,s.jsx)(i.li,{children:"transitions are committed with artifacts"}),"\n",(0,s.jsx)(i.li,{children:"no execution bypasses the machine"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Without this state machine, verifiability is impossible."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"guiding-principle",children:"Guiding Principle"}),"\n",(0,s.jsxs)(i.p,{children:["Authority is not a signal.\nAuthority is not a recommendation.\nAuthority is ",(0,s.jsx)(i.strong,{children:"state"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"If execution cannot be shown to have passed through this state machine,\nthen execution authority cannot be proven."})]})}function d(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453(e,i,n){n.d(i,{R:()=>a,x:()=>o});var t=n(6540);const s={},r=t.createContext(s);function a(e){const i=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);