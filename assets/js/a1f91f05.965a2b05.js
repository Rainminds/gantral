"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[6006],{3084(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"testing/TESTING_ARCHITECTURE_BLUEPRINT","title":"Testing Architecture Blueprint","description":"Version: v1.0 (Baseline Enforcement Model)","source":"@site/../docs/testing/TESTING_ARCHITECTURE_BLUEPRINT.md","sourceDirName":"testing","slug":"/testing/TESTING_ARCHITECTURE_BLUEPRINT","permalink":"/testing/TESTING_ARCHITECTURE_BLUEPRINT","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Testing Overview","permalink":"/testing/"},"next":{"title":"Exhaustive Master Test Inventory","permalink":"/testing/MASTER_TEST_INVENTORY"}}');var t=i(4848),r=i(8453);const l={},c="Testing Architecture Blueprint",a={},o=[{value:"<strong>1. Purpose</strong>",id:"1-purpose",level:2},{value:"<strong>2. Testing Philosophy (Non-Negotiable)</strong>",id:"2-testing-philosophy-non-negotiable",level:2},{value:"<strong>2.1 Tests Enforce Invariants, Not Features</strong>",id:"21-tests-enforce-invariants-not-features",level:3},{value:"<strong>2.2 Tests Must Be:</strong>",id:"22-tests-must-be",level:3},{value:"<strong>3. Testing Layers</strong>",id:"3-testing-layers",level:2},{value:"<strong>Layer 1 \u2013 Pure Unit Tests (Deterministic Logic)</strong>",id:"layer-1--pure-unit-tests-deterministic-logic",level:3},{value:"<strong>Layer 2 \u2013 Authority State Machine Matrix Tests</strong>",id:"layer-2--authority-state-machine-matrix-tests",level:3},{value:"<strong>Layer 3 \u2013 Artifact Integrity &amp; Tamper Tests</strong>",id:"layer-3--artifact-integrity--tamper-tests",level:3},{value:"<strong>Layer 4 \u2013 Replay &amp; Verifier Tests</strong>",id:"layer-4--replay--verifier-tests",level:3},{value:"<strong>Layer 5 \u2013 Policy Interface Tests</strong>",id:"layer-5--policy-interface-tests",level:3},{value:"<strong>Layer 6 \u2013 Integration Tests (Temporal + OPA)</strong>",id:"layer-6--integration-tests-temporal--opa",level:3},{value:"<strong>Layer 7 \u2013 Adversarial &amp; Failure Tests</strong>",id:"layer-7--adversarial--failure-tests",level:3},{value:"<strong>4. Test Naming Convention</strong>",id:"4-test-naming-convention",level:2},{value:"<strong>5. Coverage Categories</strong>",id:"5-coverage-categories",level:2},{value:"<strong>6. Required Test Enforcement Gates</strong>",id:"6-required-test-enforcement-gates",level:2}];function d(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"testing-architecture-blueprint",children:"Testing Architecture Blueprint"})}),"\n",(0,t.jsx)(n.p,{children:"Version: v1.0 (Baseline Enforcement Model)"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1-purpose",children:(0,t.jsx)(n.strong,{children:"1. Purpose"})}),"\n",(0,t.jsxs)(n.p,{children:["This document defines the ",(0,t.jsx)(n.strong,{children:"authoritative testing architecture"})," for Gantral."]}),"\n",(0,t.jsx)(n.p,{children:"It ensures that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All TRD invariants are enforced by executable tests"}),"\n",(0,t.jsx)(n.li,{children:"All PRD claims are mechanically verifiable"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Testing in Gantral is not QA.",(0,t.jsx)(n.br,{}),"\n","It is ",(0,t.jsx)(n.strong,{children:"constitutional enforcement"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-testing-philosophy-non-negotiable",children:(0,t.jsx)(n.strong,{children:"2. Testing Philosophy (Non-Negotiable)"})}),"\n",(0,t.jsx)(n.h3,{id:"21-tests-enforce-invariants-not-features",children:(0,t.jsx)(n.strong,{children:"2.1 Tests Enforce Invariants, Not Features"})}),"\n",(0,t.jsx)(n.p,{children:"Tests must verify:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Authority is state"}),"\n",(0,t.jsx)(n.li,{children:"HITL is blocking"}),"\n",(0,t.jsx)(n.li,{children:"Policy is advisory only"}),"\n",(0,t.jsx)(n.li,{children:"Artifact emission is atomic"}),"\n",(0,t.jsx)(n.li,{children:"Replay depends only on artifact chain"}),"\n",(0,t.jsx)(n.li,{children:"Fail-closed behavior everywhere"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"22-tests-must-be",children:(0,t.jsx)(n.strong,{children:"2.2 Tests Must Be:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Deterministic"}),"\n",(0,t.jsx)(n.li,{children:"Replay-safe"}),"\n",(0,t.jsx)(n.li,{children:"Network-independent (for replay tests)"}),"\n",(0,t.jsx)(n.li,{children:"Hash-chain validated"}),"\n",(0,t.jsx)(n.li,{children:"Fail-closed by design"}),"\n",(0,t.jsx)(n.li,{children:"Adversarial"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3-testing-layers",children:(0,t.jsx)(n.strong,{children:"3. Testing Layers"})}),"\n",(0,t.jsx)(n.p,{children:"Gantral testing is structured in 7 layers:"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-1--pure-unit-tests-deterministic-logic",children:(0,t.jsx)(n.strong,{children:"Layer 1 \u2013 Pure Unit Tests (Deterministic Logic)"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/unit"})}),"\n",(0,t.jsx)(n.p,{children:"Covers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"State machine transitions"}),"\n",(0,t.jsx)(n.li,{children:"Artifact hash construction"}),"\n",(0,t.jsx)(n.li,{children:"Artifact hash chain validation"}),"\n",(0,t.jsx)(n.li,{children:"Policy interpretation mapping"}),"\n",(0,t.jsx)(n.li,{children:"Input validation"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Properties:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"No network"}),"\n",(0,t.jsx)(n.li,{children:"No Temporal runtime"}),"\n",(0,t.jsx)(n.li,{children:"No DB dependency"}),"\n",(0,t.jsx)(n.li,{children:"<100ms execution"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-2--authority-state-machine-matrix-tests",children:(0,t.jsx)(n.strong,{children:"Layer 2 \u2013 Authority State Machine Matrix Tests"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/state_machine"})}),"\n",(0,t.jsxs)(n.p,{children:["Purpose:",(0,t.jsx)(n.br,{}),"\n","Exhaustively validate canonical transitions defined in TRD"]}),"\n",(0,t.jsx)(n.p,{children:"."}),"\n",(0,t.jsxs)(n.p,{children:["All allowed transitions must succeed.",(0,t.jsx)(n.br,{}),"\n","All invalid transitions must panic or terminate."]}),"\n",(0,t.jsx)(n.p,{children:"Table-driven."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-3--artifact-integrity--tamper-tests",children:(0,t.jsx)(n.strong,{children:"Layer 3 \u2013 Artifact Integrity & Tamper Tests"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/artifact"})}),"\n",(0,t.jsx)(n.p,{children:"Covers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Valid artifact chain"}),"\n",(0,t.jsx)(n.li,{children:"Hash mismatch"}),"\n",(0,t.jsx)(n.li,{children:"Corrupted artifact payload"}),"\n",(0,t.jsx)(n.li,{children:"Missing previous hash"}),"\n",(0,t.jsx)(n.li,{children:"Timestamp mutation"}),"\n",(0,t.jsx)(n.li,{children:"Authority state mutation"}),"\n",(0,t.jsx)(n.li,{children:"Policy version mutation"}),"\n",(0,t.jsx)(n.li,{children:"Actor mutation"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Replay must return:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"VALID"}),"\n",(0,t.jsx)(n.li,{children:"INVALID"}),"\n",(0,t.jsx)(n.li,{children:"INCONCLUSIVE (where defined)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Aligned to Phase 6 requirements"}),"\n",(0,t.jsx)(n.p,{children:"."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-4--replay--verifier-tests",children:(0,t.jsx)(n.strong,{children:"Layer 4 \u2013 Replay & Verifier Tests"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/replay"})}),"\n",(0,t.jsx)(n.p,{children:"Tests:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Replay with correct chain"}),"\n",(0,t.jsx)(n.li,{children:"Replay without Gantral service"}),"\n",(0,t.jsx)(n.li,{children:"Replay without DB"}),"\n",(0,t.jsx)(n.li,{children:"Replay after DB deletion"}),"\n",(0,t.jsx)(n.li,{children:"Replay after workflow code change"}),"\n",(0,t.jsx)(n.li,{children:"Replay under modified agent code"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Replay must depend only on artifact chain."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-5--policy-interface-tests",children:(0,t.jsx)(n.strong,{children:"Layer 5 \u2013 Policy Interface Tests"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/policy"})}),"\n",(0,t.jsx)(n.p,{children:"Validates:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Input schema correctness"}),"\n",(0,t.jsx)(n.li,{children:"ALLOW behavior"}),"\n",(0,t.jsx)(n.li,{children:"REQUIRE_HUMAN behavior"}),"\n",(0,t.jsx)(n.li,{children:"DENY behavior"}),"\n",(0,t.jsx)(n.li,{children:"Timeout scheduling"}),"\n",(0,t.jsx)(n.li,{children:"Escalation update"}),"\n",(0,t.jsx)(n.li,{children:"Policy engine unavailability behavior (materiality-based fail-open/closed)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Policy must never:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Pause execution directly"}),"\n",(0,t.jsx)(n.li,{children:"Approve execution directly"}),"\n",(0,t.jsx)(n.li,{children:"Emit artifacts"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-6--integration-tests-temporal--opa",children:(0,t.jsx)(n.strong,{children:"Layer 6 \u2013 Integration Tests (Temporal + OPA)"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/integration"})}),"\n",(0,t.jsx)(n.p,{children:"Tests full execution lifecycle:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Trigger instance"}),"\n",(0,t.jsx)(n.li,{children:"Policy guard"}),"\n",(0,t.jsx)(n.li,{children:"WAITING_FOR_HUMAN"}),"\n",(0,t.jsx)(n.li,{children:"Approval"}),"\n",(0,t.jsx)(n.li,{children:"Artifact emission"}),"\n",(0,t.jsx)(n.li,{children:"Resume"}),"\n",(0,t.jsx)(n.li,{children:"Completion"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Verifies:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Atomic artifact emission"}),"\n",(0,t.jsx)(n.li,{children:"No execution without artifact"}),"\n",(0,t.jsx)(n.li,{children:"No hidden retries"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"layer-7--adversarial--failure-tests",children:(0,t.jsx)(n.strong,{children:"Layer 7 \u2013 Adversarial & Failure Tests"})}),"\n",(0,t.jsx)(n.p,{children:"Location:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"/tests/adversarial"})}),"\n",(0,t.jsx)(n.p,{children:"Tests:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Artifact substitution"}),"\n",(0,t.jsx)(n.li,{children:"Log substitution"}),"\n",(0,t.jsx)(n.li,{children:"Missing artifact"}),"\n",(0,t.jsx)(n.li,{children:"Partial artifact"}),"\n",(0,t.jsx)(n.li,{children:"Authority ambiguity"}),"\n",(0,t.jsx)(n.li,{children:"Policy ambiguity"}),"\n",(0,t.jsx)(n.li,{children:"Concurrent approval attempts"}),"\n",(0,t.jsx)(n.li,{children:"Escalation owner unavailable"}),"\n",(0,t.jsx)(n.li,{children:"Timeout race conditions"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Must prove:"}),"\n",(0,t.jsx)(n.p,{children:"Gantral refuses ambiguity."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4-test-naming-convention",children:(0,t.jsx)(n.strong,{children:"4. Test Naming Convention"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Test_StateMachine_InvalidTransition_Panics"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"Test_Artifact_TamperedHash_Invalid"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"Test_Replay_WithoutDB_Succeeds"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"Test_Policy_DENY_TransitionsToTerminated"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"Test_HITL_NoDecision_BlocksExecution"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"Test_Execution_NoArtifact_FailsClosed"})]}),"\n",(0,t.jsx)(n.p,{children:"No clever names. Explicit intent only."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"5-coverage-categories",children:(0,t.jsx)(n.strong,{children:"5. Coverage Categories"})}),"\n",(0,t.jsx)(n.p,{children:"Gantral test coverage must include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"State coverage"}),"\n",(0,t.jsx)(n.li,{children:"Transition coverage"}),"\n",(0,t.jsx)(n.li,{children:"Failure coverage"}),"\n",(0,t.jsx)(n.li,{children:"Artifact mutation coverage"}),"\n",(0,t.jsx)(n.li,{children:"Replay isolation coverage"}),"\n",(0,t.jsx)(n.li,{children:"Timeout coverage"}),"\n",(0,t.jsx)(n.li,{children:"Escalation coverage"}),"\n",(0,t.jsx)(n.li,{children:"Identity coverage"}),"\n",(0,t.jsx)(n.li,{children:"Schema backward compatibility"}),"\n",(0,t.jsx)(n.li,{children:"Hash chain continuity"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"6-required-test-enforcement-gates",children:(0,t.jsx)(n.strong,{children:"6. Required Test Enforcement Gates"})}),"\n",(0,t.jsx)(n.p,{children:"CI must fail if:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"State transition coverage < 100%"}),"\n",(0,t.jsx)(n.li,{children:"Artifact schema changes without version bump"}),"\n",(0,t.jsx)(n.li,{children:"Replay tests fail"}),"\n",(0,t.jsx)(n.li,{children:"Fail-closed tests fail"}),"\n",(0,t.jsx)(n.li,{children:"Hash mutation tests pass unexpectedly"}),"\n",(0,t.jsx)(n.li,{children:"Any nondeterminism detected"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>c});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);